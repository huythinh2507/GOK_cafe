@inherits Umbraco.Cms.Web.Common.Views.UmbracoViewPage
@{
    var footerItems = new List<dynamic>();

    // Get OnFooter section from Home children
    if (UmbracoContext?.Content != null)
    {
        var homeNode = UmbracoContext.Content.GetAtRoot().FirstOrDefault(x => x.ContentType.Alias == "home" || x.ContentType.Alias == "homepage");
        if (homeNode != null)
        {
            var onFooterNode = homeNode.Children.FirstOrDefault(x => x.ContentType.Alias == "onFooter");
            if (onFooterNode != null)
            {
                // Get OnFooterItem children (up to 4 items)
                var footerItemNodes = onFooterNode.Children.Where(x => x.ContentType.Alias == "onFooterItem");
                foreach (var item in footerItemNodes.Take(4))
                {
                    var icon = item.Value<Umbraco.Cms.Core.Models.PublishedContent.IPublishedContent>("icon");
                    var iconUrl = icon != null ? icon.Url() : "";

                    footerItems.Add(new
                    {
                        Title = item.Value<string>("title") ?? item.Name,
                        Description = item.Value<string>("description") ?? "",
                        Icon = iconUrl
                    });
                }
            }
        }
    }

    // Fallback data if no Umbraco content
    if (!footerItems.Any())
    {
        footerItems = new List<dynamic>
        {
            new { Title = "Shipped FREE and to your Door", Description = "with orders above 350,000 VND", Icon = "map-marker" },
            new { Title = "Carefully delivered within 1-3 days", Description = "and packaged with love", Icon = "hand-holding-heart" },
            new { Title = "From Seed to Cup", Description = "An experience starts with only the best ingredients", Icon = "leaf" },
            new { Title = "We would love to help you", Description = "084 838 302 882", Icon = "life-ring" }
        };
    }
}

<!-- OnFooter Section -->
@if (footerItems.Any())
{
    <section class="py-0">
        <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4">
            @{
                var index = 0;
            }
            @foreach (var item in footerItems)
            {
                var bgClass = index % 2 == 0 ? "bg-gray-200" : "bg-white";
                <div class="@bgClass py-12 px-8 text-center">
                    <!-- Icon -->
                    <div class="flex items-center justify-center mb-4">
                        @if (!string.IsNullOrEmpty(item.Icon) && item.Icon.StartsWith("http"))
                        {
                            <img src="@item.Icon" alt="@item.Title" class="w-12 h-12 object-contain ol" />
                        }
                        else if (!string.IsNullOrEmpty(item.Icon))
                        {
                            <i class="fas fa-@item.Icon text-gray-800 text-4xl"></i>
                        }
                        else
                        {
                            <i class="fas fa-info-circle text-gray-800 text-4xl"></i>
                        }
                    </div>

                    <!-- Title -->
                    <h3 class="text-sm font-semibold text-gray-900 mb-2 tracking-wide">@item.Title</h3>

                    <!-- Description -->
                    <p class="text-xs text-gray-600">@item.Description</p>
                </div>
                index++;
            }
        </div>
    </section>
}
