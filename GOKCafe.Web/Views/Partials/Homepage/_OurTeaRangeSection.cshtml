@using GOKCafe.Web.Models.ViewModels
@inherits Umbraco.Cms.Web.Common.Views.UmbracoViewPage
@{
    var sectionTitle = "EXPERIENCE THE TEA ZEN";
    var sectionHeading = "OUR TEA RANGE";
    var buttonText = "Shop All Tea";
    var buttonUrl = "/tea";
    var teaItems = new List<PickupBrandItem>();

    // Get Our Tea Range section from Home children
    if (UmbracoContext?.Content != null)
    {
        var homeNode = UmbracoContext.Content.GetAtRoot().FirstOrDefault(x => x.ContentType.Alias == "home" || x.ContentType.Alias == "homepage");
        if (homeNode != null)
        {
            var ourTeaNode = homeNode.Children.FirstOrDefault(x => x.ContentType.Alias == "ourTeaRange");
            if (ourTeaNode != null)
            {
                // Get section properties
                sectionTitle = ourTeaNode.Value<string>("sectionTitle") ?? sectionTitle;
                sectionHeading = ourTeaNode.Value<string>("sectionHeading") ?? sectionHeading;
                buttonText = ourTeaNode.Value<string>("buttonText") ?? buttonText;
                buttonUrl = ourTeaNode.Value<string>("buttonUrl") ?? buttonUrl;

                // Get OurTeaRangeItem children
                var items = ourTeaNode.Children.Where(x => x.ContentType.Alias == "ourTeaRangeItem");
                foreach (var item in items.Take(6))
                {
                    var teaImage = item.Value<Umbraco.Cms.Core.Models.PublishedContent.IPublishedContent>("ourTeaRangeImage");
                    var teaImageUrl = teaImage != null ? teaImage.Url() : "";

                    teaItems.Add(new PickupBrandItem
                    {
                        Name = item.Value<string>("title") ?? item.Name,
                        Image = teaImageUrl,
                        Url = item.Url()
                    });
                }
            }
        }
    }

    // Fallback data if no Umbraco content - use static images
    if (!teaItems.Any())
    {

        var fallbackItems = new[]
        {
            new { Name = "Freshness", Image = "/images/tea/freshness.jpg" },
            new { Name = "Bubble Tea", Image = "/images/tea/bubble-tea.jpg" },
            new { Name = "Flavorful", Image = "/images/tea/flavorful.jpg" },
            new { Name = "Fruit Tea", Image = "/images/tea/fruit-tea.jpg" },
            new { Name = "Sustainability", Image = "/images/tea/sustainability.jpg" }
        };
        foreach (var item in fallbackItems)
        {
            teaItems.Add(new PickupBrandItem { Name = item.Name, Image = item.Image, Url = "#" });
        }
        teaItems = new List<PickupBrandItem>
        {
            new PickupBrandItem { Name = "Green Tea", Image = "/media/image/tearange1.png", Url = "/products" },
            new PickupBrandItem { Name = "Honey Milk Tea", Image = "/media/image/tearange2.png", Url = "/products" },
            new PickupBrandItem { Name = "Bubble Tea", Image = "/media/image/tearange3.png", Url = "/products" },
            new PickupBrandItem { Name = "Assam Black Tea", Image = "/media/image/tearange4.png", Url = "/products" },
            new PickupBrandItem { Name = "Honey Green Tea", Image = "/media/image/tearange5.png", Url = "/products" },
            new PickupBrandItem { Name = "Mango Green Tea ", Image = "/media/image/tearange6.png", Url = "/products" }
        };
    }

    var pickUpBrandItem = teaItems.Take(6).ToList();
    for (int i = 1; i < pickUpBrandItem.Count; i = i+2)
    {
        pickUpBrandItem[i].Name = "";
    }
}

<!-- Our Tea Range Section -->
<section class="pt-20 bg-white">
    <div class="container mx-auto">
        <!-- Section Header -->
        <div class="text-center mb-4">
            <p class="text-lg text-primary font-medium uppercase tracking-wide mb-1">@sectionTitle</p>
            <h2 class="text-4xl md:text-5xl font-semibold text-gray-900 md:pb-8">@sectionHeading</h2>
        </div>
        <!-- Tea Grid Layout -->
        <div class="grid sm:grid-cols-2 lg:grid-cols-3 gap-0 mb-8">
            @foreach (var item in pickUpBrandItem)
            {
                <a class="relative group overflow-hidden h-[400px] sm:h-[320px] lg:h-[380px] block bg-gray-200">
                    @if (!string.IsNullOrEmpty(item.Image))
                    {
                        <img src="@item.Image"
                             alt="@(string.IsNullOrWhiteSpace(item?.Name) ? "" : item.Name)"
                             class="w-full h-full object-cover transition-all duration-300 group-hover:scale-105
                                    @(string.IsNullOrWhiteSpace(item?.Name) ? "opacity-100" : "opacity-85")" />
                        <div class="absolute inset-0 flex items-center justify-center">
                            <h3 class="text-white text-3xl font-bold drop-shadow-lg">@item?.Name</h3>
                        </div>
                    }
                    else
                    {
                        <div class="absolute inset-0 flex items-center justify-center">
                            <h3 class="text-gray-800 text-3xl font-bold">@item.Name</h3>
                        </div>
                    }
                </a>
            }
        </div>
    </div>
</section>
