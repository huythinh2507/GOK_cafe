@inherits Umbraco.Cms.Web.Common.Views.UmbracoViewPage
@{
    // Mock products only - no Umbraco
    var mockProducts = new[]
    {
        new {Id=1,  Name = "Colombia Dark Roast", Image = "/media/tkddexzl/colombiadarkroast.png", Price = "682,000 VNĐ", Category = "Coffees" },
        new {Id=2, Name = "Swiss Water Decaf", Image = "/media/zqdncqg0/swisswaterdecaf.png", Price = "682,000 VNĐ", Category = "Coffees" },
        new {Id=3, Name = "Holiday Blend", Image = "/media/xiihorp0/holidayblend.png", Price = "682,000 VNĐ", Category = "Coffees" },
        new { Id=4,Name = "House Blend", Image = "/media/p3mhqekq/houseblend.png", Price = "682,000 VNĐ", Category = "Coffees" },
        new {Id=5, Name = "Colombia Wilton Benitez", Image = "/media/kgymu0pv/honeygreentea.png", Price = "850,000 VNĐ", Category = "Coffees" },
        new {Id=6, Name = "Assam Black Tea", Image = "/media/aptfsaia/assamblacktea.png", Price = "320,000 VNĐ", Category = "Bubble Tea" },
        new { Id=7,Name = "Honey Milk Tea", Image = "/media/cvxlg5q1/honeymilktea.png", Price = "350,000 VNĐ", Category = "Bubble Tea" },
        new {Id=8, Name = "Bubble Tea", Image = "/media/ydfosnna/bubbletee.png", Price = "400,000 VNĐ", Category = "Bubble Tea" },
        new { Id=9,Name = "Green Tea", Image = "/media/5jebon54/whiteitem.png", Price = "280,000 VNĐ", Category = "Bubble Tea" },
        new {Id=10, Name = "Honey Green Tea", Image = "/media/kgymu0pv/honeygreentea.png", Price = "320,000 VNĐ", Category = "Bubble Tea" },
        new { Id=11,Name = "Carribe Coffee", Image = "/media/kgymu0pv/honeygreentea.png", Price = "620,000 VNĐ", Category = "Coffees" },
        new {Id=12, Name = "Sweet Doughs", Image = "/media/nm0p0uau/sweetdoughs.png", Price = "180,000 VNĐ", Category = "Sweet Doughs" }
    };

    // Filter configuration data
    var filterConfig = new[]
    {
        new
        {
            Id = "category",
            Title = "Product Category",
            Options = new[] { "All categories", "Coffees", "Bubble Tea", "Sweet Doughs" },
            CheckedStates = new[] { true, true, true, true },
            HasBottomBorder = true
        },
        new
        {
            Id = "flavour",
            Title = "Flavour Profile",
            Options = new[] { "Balanced", "Bold and Bitter", "Chocolatey and Nutty", "Delicate and Complex", "Experimental", "Fruity and Punchy" },
            CheckedStates = (bool[])null,
            HasBottomBorder = true
        },
        new
        {
            Id = "availability",
            Title = "Availability",
            Options = new[] { "Instock (30)", "Out of stock (3)" },
            CheckedStates = (bool[])null,
            HasBottomBorder = true
        },
        new
        {
            Id = "equipment",
            Title = "Equipment",
            Options = new[] { "Aeropress", "Channi", "Cold Brew", "Espresso", "French Press", "Inverted Aeropress", "Moka Pot", "Pourover", "South Indian Filter" },
            CheckedStates = (bool[])null,
            HasBottomBorder = false
        }
    };

    // Helper function to render checkbox
    void RenderCheckbox(string label, bool isChecked = false)
    {
        <label class="flex items-center cursor-pointer hover:bg-primary/10 p-2 -m-2 rounded transition-colors">
            <input type="checkbox" class="w-5 h-5 accent-primary border-gray-300 rounded focus:ring-primary" @(isChecked ? "checked" : "")>
            <span class="ml-3 text-sm text-gray-700">@label</span>
        </label>
    }

    // Helper function to render filter section
    void RenderFilterSection(string id, string title, string[] options, bool hasBottomBorder = true, bool[] checkedStates = null)
    {
        <div class="@(hasBottomBorder ? "border-b border-gray-200 pb-4" : "pb-4")">
            <button class="flex items-center justify-between w-full text-left font-semibold text-gray-900 mb-4" onclick="toggleFilter('@id')">
                <span>@title</span>
                <i class="fas fa-chevron-up" id="@id-icon"></i>
            </button>
            <div id="@id-filter" class="space-y-3">
                @for (int i = 0; i < options.Length; i++)
                {
                    bool isChecked = checkedStates != null && i < checkedStates.Length && checkedStates[i];
                    RenderCheckbox(options[i], isChecked);
                }
            </div>
        </div>
    }
}

<!-- Products Grid Section -->
<section class="py-12 bg-white">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8">
        <!-- Page Title -->
        <h1 class="text-3xl font-semibold text-gray-900 mb-8">PRODUCTS LIST</h1>

        <div class="flex flex-col justify-between lg:flex-row gap-8">
            <!-- Filters Sidebar -->
            <aside class="w-full lg:w-48 flex-shrink-0">
                <div class="space-y-6">
                    @foreach (var filter in filterConfig)
                    {
                        RenderFilterSection(
                            filter.Id,
                            filter.Title,
                            filter.Options,
                            filter.HasBottomBorder,
                            filter.CheckedStates
                        );
                    }
                </div>
            </aside>

            <!-- Products Grid -->
            <div class="lg:min-w-80">
                <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 2xl:grid-cols-4 gap-8 mb-12">
                    @foreach (var product in mockProducts)
                    {
                        var priceNumber = product.Price.Replace(" VNĐ", "").Replace(",", "").Replace(".", "").Trim();
                        var productNameJson = System.Text.Json.JsonSerializer.Serialize(product.Name);
                        var productImageJson = System.Text.Json.JsonSerializer.Serialize(product.Image);
                        var productCategoryJson = System.Text.Json.JsonSerializer.Serialize(product.Category);

                        <!-- Product Card -->
                        <div class="group" data-product-id="@product.Id">
                            <!-- Product Image (Clickable) -->
                            <a href="/productdetails?id=@product.Id" class="block overflow-hidden mb-4 flex items-center justify-center bg-[#E8DCC4] w-full h-[420px] relative cursor-pointer">
                                @if (!string.IsNullOrEmpty(product.Image))
                                {
                                    <img src="@product.Image" alt="@product.Name" class="w-full h-full object-cover group-hover:scale-105 transition-transform duration-300" />
                                }
                                else
                                {
                                    <div class="w-full h-full bg-[#E8DCC4] flex items-center justify-center">
                                        <i class="fas fa-coffee text-6xl text-gray-400"></i>
                                    </div>
                                }
                            </a>

                            <!-- Product Info -->
                            <div class="text-center w-full mb-4">
                                <!-- Category -->
                                <p class="text-sm font-medium text-gray-500 uppercase mb-1">@product.Category</p>

                                <!-- Title -->
                                <h3 class="text-lg font-bold text-gray-900 mb-2 uppercase">@product.Name</h3>

                                <!-- Price -->
                                <p class="text-gray-600 mb-4">From <span class="font-semibold">@product.Price</span></p>
                            </div>

                            <!-- Buy Now Button -->
                            <button type="button"
                                    class="w-full px-4 py-3 border-2 border-primary text-primary font-semibold hover:bg-primary hover:text-white transition-all duration-300 cursor-pointer flex items-center justify-center gap-2"
                                    onclick="openProductModalFromCard(this)">
                                <i class="fas fa-shopping-cart"></i>
                                <span>Buy Now</span>
                            </button>

                            <!-- Hidden data attributes for JavaScript -->
                            <script type="application/json" class="product-data">
{
    "id": @product.Id,
    "name": @Html.Raw(productNameJson),
    "price": "@priceNumber",
    "imageUrl": @Html.Raw(productImageJson),
    "category": @Html.Raw(productCategoryJson),
    "sizes": ["250g", "500g", "1kg"],
    "grinds": ["Whole Bean", "French Press", "Filter", "Espresso"]
}
                            </script>
                        </div>
                    }
                </div>

                <!-- Pagination -->
                <div class="flex justify-center items-center gap-2 mt-8">
                    <!-- Previous Button -->
                    <button type="button" class="w-12 h-12 flex items-center justify-center border border-gray-300 text-gray-600 hover:bg-gray-50 transition-colors rounded cursor-pointer">
                        <i class="fas fa-chevron-left"></i>
                    </button>

                    <!-- Page 1 (Active) -->
                    <button type="button" class="w-12 h-12 flex items-center justify-center border-2 border-primary bg-primary text-white font-medium transition-colors rounded cursor-pointer">
                        1
                    </button>

                    <!-- Page 2 -->
                    <button type="button" class="w-12 h-12 flex items-center justify-center border border-gray-300 text-gray-700 hover:bg-gray-50 transition-colors rounded cursor-pointer">
                        2
                    </button>

                    <!-- Page 3 -->
                    <button type="button" class="w-12 h-12 flex items-center justify-center border border-gray-300 text-gray-700 hover:bg-gray-50 transition-colors rounded cursor-pointer">
                        3
                    </button>

                    <!-- Dots -->
                    <span class="px-2 text-gray-500">...</span>

                    <!-- Last Page -->
                    <button type="button" class="w-12 h-12 flex items-center justify-center border border-gray-300 text-gray-700 hover:bg-gray-50 transition-colors rounded cursor-pointer">
                        99
                    </button>

                    <!-- Next Button -->
                    <button type="button" class="w-12 h-12 flex items-center justify-center border border-gray-300 text-gray-600 hover:bg-gray-50 transition-colors rounded cursor-pointer">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>
        </div>
    </div>
</section>

<script>
function toggleFilter(filterId) {
    const filterDiv = document.getElementById(filterId + '-filter');
    const icon = document.getElementById(filterId + '-icon');

    if (filterDiv.style.display === 'none') {
        filterDiv.style.display = 'block';
        icon.classList.remove('fa-chevron-down');
        icon.classList.add('fa-chevron-up');
    } else {
        filterDiv.style.display = 'none';
        icon.classList.remove('fa-chevron-up');
        icon.classList.add('fa-chevron-down');
    }
}
</script>
